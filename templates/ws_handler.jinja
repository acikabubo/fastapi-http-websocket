from app.api.ws.constants import PkgID, RSPCode
from app.api.ws.validation import validator
from app.logging import logger
from app.routing import pkg_router
from app.schemas.generic_typing import JsonSchemaType
from app.schemas.request import RequestModel
from app.schemas.response import ResponseModel


# TODO: Define JSON schema for request data validation (optional)
# Example:
# {{ handler_name }}_schema: JsonSchemaType = {
#     "$schema": "http://json-schema.org/draft-07/schema#",
#     "type": "object",
#     "properties": {
#         "filters": {
#             "type": "object",
#             "properties": {
#                 "id": {"type": "integer"},
#                 "name": {"type": "string"},
#             },
#             "additionalProperties": False,
#         },
#     },
#     "additionalProperties": False,
# }

@pkg_router.register(
    PkgID.{{ pkg_id }},
    json_schema=None,  # TODO: Replace with your schema if validation needed
    validator_callback=None,  # TODO: Use 'validator' if schema provided
)
async def {{ handler_name }}(request: RequestModel) -> ResponseModel:
    """
    Handles {{ pkg_id }} WebSocket requests.

    Args:
        request: The WebSocket request containing request data.

    Returns:
        ResponseModel with result or error message.
    """
    try:
        # TODO: Implement your handler logic here
        # Example: Get data from request
        # data = request.data.get("key")

        return ResponseModel.ok_msg(
            request.pkg_id,
            request.req_id,
            data={"status": "success"}  # TODO: Replace with actual response data
        )
    except Exception as ex:
        logger.error(f"Error in {{ handler_name }}: {ex}")
        return ResponseModel.err_msg(
            request.pkg_id,
            request.req_id,
            msg="An error occurred while processing the request",
            status_code=RSPCode.ERROR,
        )
