{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"FastAPI HTTP/WebSocket Template","text":"<p>A production-ready FastAPI template with comprehensive HTTP and WebSocket support, including authentication, RBAC, rate limiting, audit logging, and monitoring.</p> <ul> <li> <p> Quick Start</p> <p>Get up and running in 5 minutes</p> <p> Getting Started</p> </li> <li> <p> Production Ready</p> <p>Deploy to production with confidence</p> <p> Deployment Guide</p> </li> <li> <p> Secure by Default</p> <p>Built-in authentication, RBAC, and rate limiting</p> <p> Security Guide</p> </li> <li> <p> Observable</p> <p>Prometheus metrics, Grafana dashboards, and structured logging</p> <p> Monitoring Guide</p> </li> </ul>"},{"location":"#features","title":"Features","text":""},{"location":"#dual-protocol-support","title":"Dual Protocol Support","text":"<ul> <li>\u2705 HTTP REST API - FastAPI-powered REST endpoints with OpenAPI documentation</li> <li>\u2705 WebSocket Handlers - Package-based WebSocket routing with JSON message format</li> <li>\u2705 Unified Business Logic - Share code between protocols using Repository + Command pattern</li> </ul>"},{"location":"#authentication-authorization","title":"Authentication &amp; Authorization","text":"<ul> <li>\u2705 Keycloak Integration - Enterprise-grade authentication with JWT tokens</li> <li>\u2705 RBAC System - Decorator-based role access control co-located with handlers</li> <li>\u2705 Token Validation - Automatic token verification and user extraction</li> <li>\u2705 Session Management - Redis-backed session tracking</li> </ul>"},{"location":"#rate-limiting-security","title":"Rate Limiting &amp; Security","text":"<ul> <li>\u2705 HTTP Rate Limiting - Sliding window algorithm per user/IP</li> <li>\u2705 WebSocket Rate Limiting - Connection and message rate limits</li> <li>\u2705 Redis-Backed - Distributed rate limiting across instances</li> <li>\u2705 Configurable Limits - Per-endpoint and per-user limits</li> </ul>"},{"location":"#database-persistence","title":"Database &amp; Persistence","text":"<ul> <li>\u2705 PostgreSQL - Async SQLModel/SQLAlchemy integration</li> <li>\u2705 Database Migrations - Alembic for schema versioning</li> <li>\u2705 Connection Pooling - Optimized connection management</li> <li>\u2705 Repository Pattern - Testable data access layer</li> </ul>"},{"location":"#monitoring-observability","title":"Monitoring &amp; Observability","text":"<ul> <li>\u2705 Prometheus Metrics - HTTP/WebSocket request metrics, database queries, rate limits</li> <li>\u2705 Grafana Dashboards - Pre-built dashboards for FastAPI, Keycloak, and logs</li> <li>\u2705 Structured Logging - JSON logs with correlation IDs</li> <li>\u2705 Loki Integration - Centralized log aggregation</li> </ul>"},{"location":"#audit-compliance","title":"Audit &amp; Compliance","text":"<ul> <li>\u2705 User Action Logging - Track all user actions with context</li> <li>\u2705 Async Queue Processing - Non-blocking audit log writes</li> <li>\u2705 Searchable Logs - Query audit trail with filters</li> <li>\u2705 Retention Policies - Configurable log retention</li> </ul>"},{"location":"#developer-experience","title":"Developer Experience","text":"<ul> <li>\u2705 Type Safety - Full mypy --strict compliance</li> <li>\u2705 Code Quality - Pre-commit hooks with ruff, mypy, interrogate</li> <li>\u2705 Testing - Pytest with async support, 66% coverage</li> <li>\u2705 Docker Support - Full development environment via docker-compose</li> <li>\u2705 Hot Reload - Uvicorn auto-reload during development</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<pre><code>graph TB\n    Client[Client] --&gt;|HTTP/WS| Traefik[Traefik Reverse Proxy]\n    Traefik --&gt;|:8000| App[FastAPI Application]\n\n    App --&gt;|Auth| KC[Keycloak]\n    App --&gt;|Data| PG[(PostgreSQL)]\n    App --&gt;|Cache/Rate Limit| Redis[(Redis)]\n\n    App --&gt;|Metrics| Prom[Prometheus]\n    Prom --&gt;|Dashboard| Grafana[Grafana]\n    App --&gt;|Logs| Loki[Loki]\n    Loki --&gt;|Query| Grafana\n\n    style App fill:#4051b5,stroke:#333,stroke-width:2px,color:#fff\n    style Traefik fill:#37abc8,stroke:#333,stroke-width:2px,color:#fff</code></pre>"},{"location":"#quick-example","title":"Quick Example","text":""},{"location":"#http-endpoint","title":"HTTP Endpoint","text":"<pre><code>from fastapi import APIRouter, Depends\nfrom app.dependencies import AuthorRepoDep\nfrom app.commands.author_commands import CreateAuthorCommand\nfrom app.schemas.author import CreateAuthorInput\n\nrouter = APIRouter()\n\n@router.post(\"/authors\")\nasync def create_author(\n    data: CreateAuthorInput,\n    repo: AuthorRepoDep\n) -&gt; Author:\n    \"\"\"Create a new author.\"\"\"\n    command = CreateAuthorCommand(repo)\n    return await command.execute(data)\n</code></pre>"},{"location":"#websocket-handler","title":"WebSocket Handler","text":"<pre><code>from app.routing import pkg_router\nfrom app.api.ws.constants import PkgID\nfrom app.schemas.models import RequestModel, ResponseModel\n\n@pkg_router.register(PkgID.GET_AUTHORS)\nasync def get_authors(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"Get list of authors via WebSocket.\"\"\"\n    async with async_session() as session:\n        repo = AuthorRepository(session)\n        authors = await repo.get_all()\n\n        return ResponseModel.success(\n            request.pkg_id,\n            request.req_id,\n            data=[a.model_dump() for a in authors]\n        )\n</code></pre>"},{"location":"#use-cases","title":"Use Cases","text":"<p>This template is ideal for applications requiring:</p> <ul> <li>Real-time Communication - Chat apps, live dashboards, collaborative tools</li> <li>IoT/Device Management - Device telemetry, command &amp; control</li> <li>Trading/Financial - Order management, market data streaming</li> <li>Gaming - Multiplayer game servers, lobby systems</li> <li>Monitoring - Real-time alerts, log streaming</li> </ul>"},{"location":"#technology-stack","title":"Technology Stack","text":"Component Technology Purpose Web Framework FastAPI 0.121+ High-performance async API framework ASGI Server Uvicorn Production ASGI server Database PostgreSQL 13+ Primary data store ORM SQLModel Type-safe database models Cache/Queue Redis 7+ Rate limiting, sessions, caching Authentication Keycloak Enterprise SSO and identity management Reverse Proxy Traefik v3 Load balancing, SSL termination Metrics Prometheus Time-series metrics collection Dashboards Grafana Visualization and alerting Logging Loki + Grafana Alloy Log aggregation and querying Container Docker + Compose Development and deployment"},{"location":"#project-status","title":"Project Status","text":"<ul> <li>\u2705 Production Ready - Battle-tested patterns and best practices</li> <li>\u2705 Type Safe - Full mypy compliance with strict mode</li> <li>\u2705 Well Tested - 66% coverage (target: 80%+)</li> <li>\u2705 Documented - Comprehensive guides and API reference</li> <li>\u2705 Observable - Full monitoring and logging stack</li> <li>\u2705 Secure - Authentication, RBAC, rate limiting, audit logs</li> </ul>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li> <p>New to the project?</p> <p>Start with the Installation Guide to set up your development environment.</p> </li> <li> <p>Ready to build?</p> <p>Follow the Quick Start to create your first endpoints.</p> </li> <li> <p>Deploying to production?</p> <p>Check out the Production Deployment Guide.</p> </li> <li> <p>Want to contribute?</p> <p>Read the Contributing Guide to get started.</p> </li> </ul>"},{"location":"#license","title":"License","text":"<p>This project is licensed under the MIT License - see the LICENSE file for details.</p>"},{"location":"#support","title":"Support","text":"<ul> <li>\ud83d\udcd6 Documentation</li> <li>\ud83d\udc1b Issue Tracker</li> <li>\ud83d\udcac Discussions</li> </ul>"},{"location":"api-reference/","title":"API Reference","text":"<p>Complete reference documentation for HTTP and WebSocket APIs.</p>"},{"location":"api-reference/#api-documentation","title":"API Documentation","text":"<ul> <li>HTTP API - REST endpoint reference</li> <li>WebSocket API - WebSocket handler reference</li> <li>Response Models - Response format specifications</li> <li>Exceptions - Error handling and status codes</li> </ul>"},{"location":"api-reference/#interactive-documentation","title":"Interactive Documentation","text":"<p>When running locally, visit:</p> <ul> <li>Swagger UI: http://localhost:8000/docs</li> <li>ReDoc: http://localhost:8000/redoc</li> <li>OpenAPI JSON: http://localhost:8000/openapi.json</li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>Learn about the system architecture, design patterns, and technical decisions.</p>"},{"location":"architecture/#contents","title":"Contents","text":"<ul> <li>Overview - System architecture and component interactions</li> <li>Design Patterns - Repository, Command, and Dependency Injection patterns</li> <li>Request Flow - HTTP and WebSocket request processing</li> <li>RBAC System - Role-based access control implementation</li> </ul>"},{"location":"architecture/#architecture-diagram","title":"Architecture Diagram","text":"<pre><code>graph TB\n    Client[Client] --&gt;|HTTP/WS| Traefik[Traefik]\n    Traefik --&gt; App[FastAPI App]\n    App --&gt; PG[(PostgreSQL)]\n    App --&gt; Redis[(Redis)]\n    App --&gt; KC[Keycloak]</code></pre> <p>See Overview for detailed architecture documentation.</p>"},{"location":"architecture/rbac/","title":"RBAC System","text":"<p>Role-Based Access Control (RBAC) in this application uses a decorator-based approach where permissions are defined directly in handler code.</p>"},{"location":"architecture/rbac/#overview","title":"Overview","text":"<p>The RBAC system provides:</p> <ul> <li>Decorator-based permissions - Roles defined directly with handlers</li> <li>Type-safe - All permissions in Python code, not external files</li> <li>Co-located - Permissions live next to the code they protect</li> <li>Two protocols - Works for both HTTP and WebSocket</li> </ul>"},{"location":"architecture/rbac/#components","title":"Components","text":""},{"location":"architecture/rbac/#rbacmanager","title":"RBACManager","text":"<p>Singleton manager for permission checking:</p> <ul> <li><code>check_ws_permission(pkg_id, user)</code> - Validates WebSocket permissions</li> <li><code>require_roles(*roles)</code> - FastAPI dependency for HTTP endpoints</li> <li>Reads from <code>pkg_router.permissions_registry</code> for WebSocket</li> <li>No external configuration files needed</li> </ul> <p>Location: <code>app/managers/rbac_manager.py</code></p>"},{"location":"architecture/rbac/#permissions-registry","title":"Permissions Registry","text":"<p>The <code>PackageRouter</code> maintains a registry of required roles for each WebSocket handler:</p> <pre><code># Internal registry structure\npermissions_registry: dict[PkgID, list[str]] = {\n    PkgID.GET_AUTHORS: [\"get-authors\"],\n    PkgID.CREATE_AUTHOR: [\"create-author\", \"admin\"],\n    PkgID.DELETE_AUTHOR: [\"delete-author\", \"admin\"]\n}\n</code></pre>"},{"location":"architecture/rbac/#websocket-rbac","title":"WebSocket RBAC","text":""},{"location":"architecture/rbac/#defining-permissions","title":"Defining Permissions","text":"<p>Use the <code>roles</code> parameter in the <code>@pkg_router.register()</code> decorator:</p> <pre><code>from app.routing import pkg_router\nfrom app.api.ws.constants import PkgID\nfrom app.schemas.request import RequestModel\nfrom app.schemas.response import ResponseModel\n\n@pkg_router.register(\n    PkgID.GET_AUTHORS,\n    json_schema=GetAuthorsModel,\n    roles=[\"get-authors\"]  # Required roles\n)\nasync def get_authors_handler(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"Get all authors - requires 'get-authors' role.\"\"\"\n    # Handler implementation\n    ...\n</code></pre>"},{"location":"architecture/rbac/#multiple-roles","title":"Multiple Roles","text":"<p>User must have ALL specified roles:</p> <pre><code>@pkg_router.register(\n    PkgID.DELETE_AUTHOR,\n    roles=[\"delete-author\", \"admin\"]  # Requires BOTH roles\n)\nasync def delete_author_handler(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"Delete author - requires both 'delete-author' AND 'admin' roles.\"\"\"\n    ...\n</code></pre>"},{"location":"architecture/rbac/#public-endpoints","title":"Public Endpoints","text":"<p>Omit the <code>roles</code> parameter for public access (no authentication required):</p> <pre><code>@pkg_router.register(\n    PkgID.PUBLIC_DATA,\n    json_schema=PublicDataSchema\n    # No roles parameter = public access\n)\nasync def public_handler(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"Public endpoint - no authentication required.\"\"\"\n    ...\n</code></pre>"},{"location":"architecture/rbac/#http-rbac","title":"HTTP RBAC","text":""},{"location":"architecture/rbac/#defining-permissions_1","title":"Defining Permissions","text":"<p>Use the <code>require_roles()</code> FastAPI dependency:</p> <pre><code>from fastapi import APIRouter, Depends\nfrom app.dependencies.permissions import require_roles\nfrom app.schemas.author import Author\n\nrouter = APIRouter(prefix=\"/api\", tags=[\"authors\"])\n\n@router.get(\n    \"/authors\",\n    dependencies=[Depends(require_roles(\"get-authors\"))]\n)\nasync def get_authors() -&gt; list[Author]:\n    \"\"\"Get all authors - requires 'get-authors' role.\"\"\"\n    ...\n</code></pre>"},{"location":"architecture/rbac/#multiple-roles_1","title":"Multiple Roles","text":"<p>User must have ALL specified roles:</p> <pre><code>@router.delete(\n    \"/authors/{author_id}\",\n    dependencies=[Depends(require_roles(\"delete-author\", \"admin\"))]\n)\nasync def delete_author(author_id: int):\n    \"\"\"Delete author - requires BOTH 'delete-author' AND 'admin' roles.\"\"\"\n    ...\n</code></pre>"},{"location":"architecture/rbac/#public-endpoints_1","title":"Public Endpoints","text":"<p>Omit the <code>dependencies</code> parameter for public access:</p> <pre><code>@router.get(\"/health\")\nasync def health_check():\n    \"\"\"Public endpoint - no authentication required.\"\"\"\n    return {\"status\": \"healthy\"}\n</code></pre>"},{"location":"architecture/rbac/#permission-flow","title":"Permission Flow","text":""},{"location":"architecture/rbac/#http-request-flow","title":"HTTP Request Flow","text":"<pre><code>1. Client sends request with JWT token\n   \u2193\n2. AuthenticationMiddleware validates token\n   \u2193\n3. require_roles() dependency checks user roles\n   \u2193\n   \u251c\u2500 User has required roles \u2192 Continue to handler\n   \u2514\u2500 User missing roles \u2192 Return 403 Forbidden\n</code></pre>"},{"location":"architecture/rbac/#websocket-request-flow","title":"WebSocket Request Flow","text":"<pre><code>1. Client connects with JWT token in query params\n   \u2193\n2. PackageAuthWebSocketEndpoint validates token\n   \u2193\n3. Client sends message with pkg_id\n   \u2193\n4. PackageRouter.handle_request() checks permissions\n   \u2193\n5. RBACManager.check_ws_permission(pkg_id, user)\n   \u2193\n   \u251c\u2500 User has required roles \u2192 Dispatch to handler\n   \u2514\u2500 User missing roles \u2192 Return error response\n</code></pre>"},{"location":"architecture/rbac/#role-management","title":"Role Management","text":""},{"location":"architecture/rbac/#defining-roles-in-keycloak","title":"Defining Roles in Keycloak","text":"<p>Roles are managed in Keycloak:</p> <ol> <li>Log into Keycloak Admin Console</li> <li>Select your realm</li> <li>Navigate to Roles \u2192 Realm roles</li> <li>Click Create role</li> <li>Define role name (e.g., <code>get-authors</code>, <code>create-author</code>)</li> </ol>"},{"location":"architecture/rbac/#assigning-roles-to-users","title":"Assigning Roles to Users","text":"<ol> <li>Navigate to Users in Keycloak Admin</li> <li>Select the user</li> <li>Go to Role mapping tab</li> <li>Click Assign role</li> <li>Select the roles to assign</li> </ol>"},{"location":"architecture/rbac/#role-naming-convention","title":"Role Naming Convention","text":"<p>Follow these conventions for consistency:</p> <ul> <li>Use kebab-case: <code>get-authors</code>, <code>create-author</code></li> <li>Use descriptive names: <code>delete-author</code> not <code>del-auth</code></li> <li>Resource-action format: <code>{action}-{resource}</code></li> <li>Examples:</li> <li><code>get-authors</code> - View authors</li> <li><code>create-author</code> - Create new authors</li> <li><code>update-author</code> - Modify authors</li> <li><code>delete-author</code> - Remove authors</li> <li><code>admin</code> - Administrative privileges</li> </ul>"},{"location":"architecture/rbac/#common-patterns","title":"Common Patterns","text":""},{"location":"architecture/rbac/#read-only-access","title":"Read-Only Access","text":"<pre><code># WebSocket\n@pkg_router.register(PkgID.GET_AUTHORS, roles=[\"viewer\"])\n\n# HTTP\n@router.get(\"/authors\", dependencies=[Depends(require_roles(\"viewer\"))])\n</code></pre>"},{"location":"architecture/rbac/#write-access","title":"Write Access","text":"<pre><code># WebSocket\n@pkg_router.register(PkgID.CREATE_AUTHOR, roles=[\"editor\"])\n\n# HTTP\n@router.post(\"/authors\", dependencies=[Depends(require_roles(\"editor\"))])\n</code></pre>"},{"location":"architecture/rbac/#admin-only-access","title":"Admin-Only Access","text":"<pre><code># WebSocket\n@pkg_router.register(PkgID.DELETE_AUTHOR, roles=[\"admin\"])\n\n# HTTP\n@router.delete(\"/authors/{id}\", dependencies=[Depends(require_roles(\"admin\"))])\n</code></pre>"},{"location":"architecture/rbac/#combined-permissions","title":"Combined Permissions","text":"<p>Require both a specific permission AND admin role:</p> <pre><code># WebSocket\n@pkg_router.register(\n    PkgID.DELETE_AUTHOR,\n    roles=[\"delete-author\", \"admin\"]\n)\n\n# HTTP\n@router.delete(\n    \"/authors/{id}\",\n    dependencies=[Depends(require_roles(\"delete-author\", \"admin\"))]\n)\n</code></pre>"},{"location":"architecture/rbac/#troubleshooting","title":"Troubleshooting","text":""},{"location":"architecture/rbac/#permission-denied-403","title":"Permission Denied (403)","text":"<p>Symptom: Users get 403 Forbidden errors</p> <p>Diagnosis: <pre><code># Check user roles in Keycloak\n# Admin Console \u2192 Users \u2192 &lt;user&gt; \u2192 Role Mappings\n\n# Check handler code for required roles\n# WebSocket: @pkg_router.register(PkgID.*, roles=[\"role-name\"])\n# HTTP: dependencies=[Depends(require_roles(\"role-name\"))]\n\n# Check application logs\ndocker logs hw-server | grep -i \"permission\\|rbac\"\n</code></pre></p> <p>Solution:</p> <ol> <li>Verify user has the required role(s) in Keycloak</li> <li>Check handler decorator to see what roles are required</li> <li>Ensure JWT token includes the roles (check token claims)</li> </ol>"},{"location":"architecture/rbac/#finding-required-roles","title":"Finding Required Roles","text":"<p>To find what roles are required for an endpoint:</p> <p>WebSocket: <pre><code># Search handler code\ngrep -r \"@pkg_router.register\" app/api/ws/handlers/ | grep \"PkgID.YOUR_HANDLER\"\n</code></pre></p> <p>HTTP: <pre><code># Search endpoint code\ngrep -r \"require_roles\" app/api/http/\n</code></pre></p>"},{"location":"architecture/rbac/#testing-rbac","title":"Testing RBAC","text":"<pre><code># tests/test_rbac.py\nimport pytest\nfrom app.managers.rbac_manager import RBACManager\nfrom app.schemas.user import UserModel\n\ndef test_user_with_correct_role():\n    \"\"\"Test user with correct role can access endpoint.\"\"\"\n    user = UserModel(\n        sub=\"user123\",\n        username=\"testuser\",\n        roles=[\"get-authors\"]\n    )\n    rbac = RBACManager()\n\n    # Should allow access\n    assert rbac.check_ws_permission(PkgID.GET_AUTHORS, user) is True\n\ndef test_user_without_role():\n    \"\"\"Test user without role is denied access.\"\"\"\n    user = UserModel(\n        sub=\"user123\",\n        username=\"testuser\",\n        roles=[\"viewer\"]  # Missing 'get-authors'\n    )\n    rbac = RBACManager()\n\n    # Should deny access\n    assert rbac.check_ws_permission(PkgID.GET_AUTHORS, user) is False\n</code></pre>"},{"location":"architecture/rbac/#best-practices","title":"Best Practices","text":""},{"location":"architecture/rbac/#1-principle-of-least-privilege","title":"1. Principle of Least Privilege","text":"<p>Only grant the minimum roles needed:</p> <pre><code># Good - specific permission\n@pkg_router.register(PkgID.GET_AUTHORS, roles=[\"get-authors\"])\n\n# Avoid - overly broad\n@pkg_router.register(PkgID.GET_AUTHORS, roles=[\"admin\"])\n</code></pre>"},{"location":"architecture/rbac/#2-descriptive-role-names","title":"2. Descriptive Role Names","text":"<p>Use clear, descriptive role names:</p> <pre><code># Good\nroles=[\"create-author\", \"update-author\"]\n\n# Avoid\nroles=[\"writer\", \"modifier\"]\n</code></pre>"},{"location":"architecture/rbac/#3-co-locate-permissions","title":"3. Co-locate Permissions","text":"<p>Define permissions next to the code they protect:</p> <pre><code># Good - roles defined with handler\n@pkg_router.register(\n    PkgID.DELETE_AUTHOR,\n    roles=[\"delete-author\", \"admin\"]\n)\nasync def delete_author_handler(request: RequestModel):\n    ...\n\n# This makes it obvious what roles are required\n</code></pre>"},{"location":"architecture/rbac/#4-document-role-requirements","title":"4. Document Role Requirements","text":"<p>Add docstrings explaining what roles are required:</p> <pre><code>@pkg_router.register(\n    PkgID.DELETE_AUTHOR,\n    roles=[\"delete-author\", \"admin\"]\n)\nasync def delete_author_handler(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"\n    Delete an author.\n\n    Requires BOTH 'delete-author' AND 'admin' roles.\n    User must have all specified roles to access this endpoint.\n    \"\"\"\n    ...\n</code></pre>"},{"location":"architecture/rbac/#5-test-rbac-logic","title":"5. Test RBAC Logic","text":"<p>Always write tests for permission checks:</p> <pre><code># Test both allowed and denied scenarios\ndef test_authorized_access():\n    \"\"\"Test user with correct roles can access.\"\"\"\n    ...\n\ndef test_unauthorized_access():\n    \"\"\"Test user without roles is denied.\"\"\"\n    ...\n</code></pre>"},{"location":"architecture/rbac/#security-considerations","title":"Security Considerations","text":""},{"location":"architecture/rbac/#token-validation","title":"Token Validation","text":"<ul> <li>JWT tokens are validated on every request</li> <li>Expired tokens are automatically rejected</li> <li>Token signature is verified against Keycloak public key</li> </ul>"},{"location":"architecture/rbac/#role-extraction","title":"Role Extraction","text":"<ul> <li>Roles are extracted from <code>realm_access.roles</code> in JWT</li> <li>Only roles from the configured Keycloak realm are used</li> <li>Invalid or missing role claims result in empty role list</li> </ul>"},{"location":"architecture/rbac/#permission-checking","title":"Permission Checking","text":"<ul> <li>User must have ALL required roles (AND logic)</li> <li>No roles specified = public access (use cautiously)</li> <li>Permission denied returns 403 Forbidden (not 401)</li> </ul>"},{"location":"architecture/rbac/#related-documentation","title":"Related Documentation","text":"<ul> <li>Authentication Guide - Setting up Keycloak and users</li> <li>HTTP API Reference - HTTP endpoint documentation</li> <li>WebSocket API Reference - WebSocket handler documentation</li> <li>Testing Guide - Testing RBAC logic</li> </ul>"},{"location":"cookiecutter/","title":"Cookiecutter Template","text":"<p>This project can be used as a Cookiecutter template to generate new projects.</p>"},{"location":"cookiecutter/#contents","title":"Contents","text":"<ul> <li>Overview - Template features and structure</li> <li>Customization - Customizing the generated project</li> <li>Examples - Example projects built with this template</li> </ul>"},{"location":"cookiecutter/#quick-start","title":"Quick Start","text":"<p>```bash</p>"},{"location":"cookiecutter/#install-cookiecutter","title":"Install cookiecutter","text":"<p>pip install cookiecutter</p>"},{"location":"cookiecutter/#generate-new-project","title":"Generate new project","text":"<p>cookiecutter gh:acikabubo/fastapi-http-websocket</p>"},{"location":"cookiecutter/#follow-the-prompts-to-customize-your-project","title":"Follow the prompts to customize your project","text":"<p>```</p> <p>See Overview for more information.</p>"},{"location":"deployment/","title":"Deployment","text":"<p>Production deployment guides and operational documentation.</p>"},{"location":"deployment/#deployment-guides","title":"Deployment Guides","text":"<ul> <li>Docker Deployment - Container-based deployment</li> <li>Production Setup - Production configuration and best practices</li> <li>Security Guide - Security hardening and best practices</li> <li>Monitoring &amp; Observability - Setting up monitoring stack</li> <li>Troubleshooting - Common issues and solutions</li> <li>Backup &amp; Recovery - Data protection strategies</li> </ul>"},{"location":"deployment/#quick-deploy","title":"Quick Deploy","text":"<p>```bash</p>"},{"location":"deployment/#using-docker-compose","title":"Using Docker Compose","text":"<p>docker-compose -f docker-compose.prod.yml up -d</p>"},{"location":"deployment/#or-using-the-makefile","title":"Or using the Makefile","text":"<p>make deploy-prod ```</p> <p>See Production Setup for detailed deployment procedures.</p>"},{"location":"development/","title":"Development","text":"<p>Resources for developers contributing to the project.</p>"},{"location":"development/#development-guides","title":"Development Guides","text":"<ul> <li>Setup - Development environment setup</li> <li>Testing - Writing and running tests</li> <li>Database Migrations - Managing database schema</li> <li>Code Quality - Linting, formatting, and best practices</li> <li>Contributing - Contribution guidelines</li> </ul>"},{"location":"development/#quick-commands","title":"Quick Commands","text":"<p>```bash</p>"},{"location":"development/#run-tests","title":"Run tests","text":"<p>make test</p>"},{"location":"development/#start-development-server","title":"Start development server","text":"<p>make serve</p>"},{"location":"development/#run-linter","title":"Run linter","text":"<p>make ruff-check</p>"},{"location":"development/#create-migration","title":"Create migration","text":"<p>make migration msg=\"add new field\" ```</p>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Welcome to the FastAPI HTTP/WebSocket Template! This guide will help you get up and running quickly.</p>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, ensure you have the following installed:</p> <ul> <li>Python 3.13+ - Download Python</li> <li>Docker &amp; Docker Compose - Install Docker</li> <li>uv - Python package manager: <code>pip install uv</code></li> <li>Git - Version control</li> </ul>"},{"location":"getting-started/#quick-setup","title":"Quick Setup","text":"<p>Follow these three steps to get started:</p> <ol> <li>Installation - Set up your development environment</li> <li>Quick Start - Create your first endpoints</li> <li>Configuration - Configure services and environment</li> </ol>"},{"location":"getting-started/#what-youll-build","title":"What You'll Build","text":"<p>By the end of this guide, you'll have:</p> <ul> <li>\u2705 A running FastAPI application with HTTP and WebSocket support</li> <li>\u2705 Keycloak authentication with JWT tokens</li> <li>\u2705 PostgreSQL database with migrations</li> <li>\u2705 Redis for caching and rate limiting</li> <li>\u2705 Prometheus metrics and Grafana dashboards</li> <li>\u2705 Full observability stack (logs, metrics, traces)</li> </ul>"},{"location":"getting-started/#learning-path","title":"Learning Path","text":"BeginnersExperienced Developers <ol> <li>Start with Installation</li> <li>Follow the Quick Start guide</li> <li>Learn about Authentication</li> <li>Explore HTTP Endpoints</li> </ol> <ol> <li>Review Architecture Overview</li> <li>Check Design Patterns</li> <li>Jump to API Reference</li> <li>Deploy with Production Guide</li> </ol>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li> <p> Install</p> <p>Set up your development environment</p> <p> Installation Guide</p> </li> <li> <p> Quick Start</p> <p>Build your first endpoints in 10 minutes</p> <p> Quick Start</p> </li> <li> <p> Configure</p> <p>Configure services and environment</p> <p> Configuration</p> </li> </ul>"},{"location":"getting-started/configuration/","title":"Configuration","text":"<p>Learn how to configure the application and its services for different environments.</p>"},{"location":"getting-started/configuration/#environment-files","title":"Environment Files","text":"<p>The project uses multiple environment files:</p> File Purpose Location <code>.env</code> Application configuration Project root <code>docker/.srv_env</code> Service environment Docker directory <code>docker/.pg_env</code> PostgreSQL credentials Docker directory <code>docker/.kc_env</code> Keycloak configuration Docker directory"},{"location":"getting-started/configuration/#application-configuration","title":"Application Configuration","text":""},{"location":"getting-started/configuration/#env-file","title":".env File","text":"<p>Create <code>.env</code> in the project root:</p> <pre><code># ========================================\n# Application Settings\n# ========================================\nENVIRONMENT=development  # development, staging, production\nDEBUG=true\nLOG_LEVEL=DEBUG  # DEBUG, INFO, WARNING, ERROR, CRITICAL\n\n# ========================================\n# Database Configuration\n# ========================================\nDATABASE_URL=postgresql+asyncpg://fastapi:fastapi@localhost:5432/fastapi\nDB_POOL_SIZE=20\nDB_MAX_OVERFLOW=10\n\n# ========================================\n# Redis Configuration\n# ========================================\nREDIS_IP=localhost\nREDIS_PORT=6379\nREDIS_PASSWORD=  # Leave empty for no auth in development\nMAIN_REDIS_DB=0\nAUTH_REDIS_DB=1\nREDIS_MAX_CONNECTIONS=50\n\n# ========================================\n# Keycloak Configuration\n# ========================================\nKEYCLOAK_BASE_URL=http://localhost:8080\nKEYCLOAK_REALM=development\nKEYCLOAK_CLIENT_ID=fastapi-app\nKEYCLOAK_CLIENT_SECRET=your-client-secret-here\n\nKEYCLOAK_ADMIN_USERNAME=admin\nKEYCLOAK_ADMIN_PASSWORD=admin\n\n# ========================================\n# Security\n# ========================================\nSECRET_KEY=your-secret-key-here  # Generate with: openssl rand -hex 32\nALLOWED_HOSTS=[\"localhost\", \"127.0.0.1\"]\nCORS_ORIGINS=[\"http://localhost:3000\", \"http://localhost:8000\"]\n\n# ========================================\n# Rate Limiting\n# ========================================\nRATE_LIMIT_ENABLED=true\nRATE_LIMIT_PER_MINUTE=60\nRATE_LIMIT_BURST=10\nWS_MAX_CONNECTIONS_PER_USER=5\nWS_MESSAGE_RATE_LIMIT=100\n\n# ========================================\n# Monitoring\n# ========================================\nPROMETHEUS_ENABLED=true\nLOKI_URL=http://localhost:3100\n\n# ========================================\n# Logging\n# ========================================\nLOG_CONSOLE_FORMAT=human  # human or json\nAUDIT_QUEUE_MAX_SIZE=10000\n</code></pre>"},{"location":"getting-started/configuration/#docker-services-configuration","title":"Docker Services Configuration","text":""},{"location":"getting-started/configuration/#postgresql-dockerpg_env","title":"PostgreSQL (docker/.pg_env)","text":"<pre><code>POSTGRES_USER=fastapi\nPOSTGRES_PASSWORD=fastapi\nPOSTGRES_DB=fastapi\n</code></pre>"},{"location":"getting-started/configuration/#keycloak-dockerkc_env","title":"Keycloak (docker/.kc_env)","text":"<pre><code>KEYCLOAK_ADMIN=admin\nKEYCLOAK_ADMIN_PASSWORD=admin\n\nKC_DB=postgres\nKC_DB_URL_HOST=hw-db\nKC_DB_URL_DATABASE=keycloak\nKC_DB_URL_PORT=5432\nKC_DB_USERNAME=fastapi\nKC_DB_PASSWORD=fastapi\n\nKC_HOSTNAME=localhost\nKC_HTTP_ENABLED=true\nKC_HOSTNAME_STRICT=false\nKC_PROXY=edge\n\nKC_METRICS_ENABLED=true\nKC_HEALTH_ENABLED=true\n</code></pre>"},{"location":"getting-started/configuration/#application-service-dockersrv_env","title":"Application Service (docker/.srv_env)","text":"<pre><code>LOG_CONSOLE_FORMAT=human  # human for development, json for production\n</code></pre>"},{"location":"getting-started/configuration/#configuration-options","title":"Configuration Options","text":""},{"location":"getting-started/configuration/#database-settings","title":"Database Settings","text":"Variable Default Description <code>DATABASE_URL</code> - PostgreSQL connection string <code>DB_POOL_SIZE</code> 20 Connection pool size <code>DB_MAX_OVERFLOW</code> 10 Max overflow connections"},{"location":"getting-started/configuration/#redis-settings","title":"Redis Settings","text":"Variable Default Description <code>REDIS_IP</code> localhost Redis host <code>REDIS_PORT</code> 6379 Redis port <code>MAIN_REDIS_DB</code> 0 Main Redis database number <code>AUTH_REDIS_DB</code> 1 Auth Redis database number <code>REDIS_MAX_CONNECTIONS</code> 50 Max Redis connections"},{"location":"getting-started/configuration/#rate-limiting","title":"Rate Limiting","text":"Variable Default Description <code>RATE_LIMIT_ENABLED</code> true Enable rate limiting <code>RATE_LIMIT_PER_MINUTE</code> 60 HTTP requests per minute <code>RATE_LIMIT_BURST</code> 10 Burst allowance <code>WS_MAX_CONNECTIONS_PER_USER</code> 5 Max WebSocket connections per user <code>WS_MESSAGE_RATE_LIMIT</code> 100 WebSocket messages per minute"},{"location":"getting-started/configuration/#logging","title":"Logging","text":"Variable Default Description <code>LOG_LEVEL</code> INFO Logging level <code>LOG_CONSOLE_FORMAT</code> human Log format (human/json) <code>AUDIT_QUEUE_MAX_SIZE</code> 10000 Audit log queue size"},{"location":"getting-started/configuration/#environment-specific-configuration","title":"Environment-Specific Configuration","text":""},{"location":"getting-started/configuration/#development","title":"Development","text":"<pre><code>ENVIRONMENT=development\nDEBUG=true\nLOG_LEVEL=DEBUG\nLOG_CONSOLE_FORMAT=human\nRATE_LIMIT_PER_MINUTE=1000  # Higher limits for testing\n</code></pre>"},{"location":"getting-started/configuration/#staging","title":"Staging","text":"<pre><code>ENVIRONMENT=staging\nDEBUG=false\nLOG_LEVEL=INFO\nLOG_CONSOLE_FORMAT=json\nRATE_LIMIT_PER_MINUTE=120\n</code></pre>"},{"location":"getting-started/configuration/#production","title":"Production","text":"<pre><code>ENVIRONMENT=production\nDEBUG=false\nLOG_LEVEL=WARNING\nLOG_CONSOLE_FORMAT=json\nRATE_LIMIT_PER_MINUTE=60\n\n# Use strong secrets\nSECRET_KEY=&lt;generated-with-openssl-rand&gt;\nKEYCLOAK_CLIENT_SECRET=&lt;from-keycloak-admin&gt;\n\n# Use production domains\nKEYCLOAK_BASE_URL=https://auth.example.com\nALLOWED_HOSTS=[\"api.example.com\"]\nCORS_ORIGINS=[\"https://app.example.com\"]\n</code></pre>"},{"location":"getting-started/configuration/#keycloak-configuration","title":"Keycloak Configuration","text":""},{"location":"getting-started/configuration/#creating-a-realm","title":"Creating a Realm","text":"<ol> <li>Access Keycloak admin console: http://localhost:8080</li> <li>Login with admin credentials</li> <li>Create a new realm (e.g., \"development\")</li> <li>Configure realm settings</li> </ol>"},{"location":"getting-started/configuration/#creating-a-client","title":"Creating a Client","text":"<ol> <li>Go to Clients \u2192 Create</li> <li>Set Client ID: <code>fastapi-app</code></li> <li>Enable \"Client authentication\"</li> <li>Set Valid redirect URIs: <code>http://localhost:8000/*</code></li> <li>Set Web origins: <code>http://localhost:8000</code></li> <li>Save and copy the client secret</li> </ol>"},{"location":"getting-started/configuration/#creating-roles","title":"Creating Roles","text":"<ol> <li>Go to Realm roles \u2192 Create role</li> <li>Create roles: <code>admin</code>, <code>user</code>, <code>viewer</code></li> <li>Assign roles to users</li> </ol>"},{"location":"getting-started/configuration/#creating-users","title":"Creating Users","text":"<ol> <li>Go to Users \u2192 Add user</li> <li>Set username and email</li> <li>Go to Credentials tab \u2192 Set password</li> <li>Go to Role mapping \u2192 Assign roles</li> </ol>"},{"location":"getting-started/configuration/#rbac-configuration","title":"RBAC Configuration","text":"<p>Role-based access control is configured directly in handler code using decorators:</p> <p>WebSocket Handlers (<code>app/api/ws/handlers/</code>): <pre><code>@pkg_router.register(\n    PkgID.GET_AUTHORS,\n    json_schema=GetAuthorsModel,\n    roles=[\"get-authors\"]  # Define required roles here\n)\nasync def get_authors_handler(request: RequestModel) -&gt; ResponseModel:\n    ...\n</code></pre></p> <p>HTTP Endpoints (<code>app/api/http/</code>): <pre><code>from app.dependencies.permissions import require_roles\n\n@router.get(\n    \"/authors\",\n    dependencies=[Depends(require_roles(\"get-authors\"))]\n)\nasync def get_authors():\n    ...\n</code></pre></p> <p>No external configuration file needed - permissions are co-located with handler code.</p>"},{"location":"getting-started/configuration/#docker-compose-configuration","title":"Docker Compose Configuration","text":"<p>The <code>docker-compose.yml</code> file can be customized for different environments:</p>"},{"location":"getting-started/configuration/#development_1","title":"Development","text":"<pre><code>services:\n  hw-server:\n    volumes:\n      - .:/app  # Mount code for hot reload\n    command: uvicorn app:application --reload\n    environment:\n      - DEBUG=true\n</code></pre>"},{"location":"getting-started/configuration/#production_1","title":"Production","text":"<pre><code>services:\n  hw-server:\n    image: fastapi-app:latest  # Use built image\n    deploy:\n      replicas: 3\n      resources:\n        limits:\n          cpus: '2'\n          memory: 2G\n    environment:\n      - DEBUG=false\n</code></pre>"},{"location":"getting-started/configuration/#monitoring-configuration","title":"Monitoring Configuration","text":""},{"location":"getting-started/configuration/#prometheus-dockerprometheusprometheusyml","title":"Prometheus (docker/prometheus/prometheus.yml)","text":"<pre><code>global:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: 'fastapi'\n    static_configs:\n      - targets: ['hw-server:8000']\n</code></pre>"},{"location":"getting-started/configuration/#grafana-dockergrafanaprovisioning","title":"Grafana (docker/grafana/provisioning/)","text":"<p>Grafana is pre-configured with: - Data sources (Prometheus, Loki) - Dashboards (FastAPI Metrics, Application Logs, Keycloak Metrics) - Default admin credentials: admin/admin</p>"},{"location":"getting-started/configuration/#troubleshooting-configuration","title":"Troubleshooting Configuration","text":""},{"location":"getting-started/configuration/#check-current-configuration","title":"Check Current Configuration","text":"<pre><code># Inside the application\nuv run python -c \"from app.settings import settings; print(settings.model_dump())\"\n\n# Or use IPython\nmake ipython\n&gt;&gt;&gt; from app.settings import settings\n&gt;&gt;&gt; settings.DATABASE_URL\n</code></pre>"},{"location":"getting-started/configuration/#validate-environment-files","title":"Validate Environment Files","text":"<pre><code># Check if all required variables are set\ngrep -v '^#' .env | grep -v '^$' | sort\n\n# Validate docker environment files\nls -la docker/.*.env\n</code></pre>"},{"location":"getting-started/configuration/#common-issues","title":"Common Issues","text":"<p>Issue: <code>DATABASE_URL</code> not found <pre><code># Solution: Ensure .env file exists\ncp .env.example .env\n</code></pre></p> <p>Issue: Keycloak connection refused <pre><code># Solution: Ensure Keycloak is running\ndocker ps | grep keycloak\ndocker logs hw-keycloak\n</code></pre></p> <p>Issue: Redis connection error <pre><code># Solution: Check Redis is accessible\ndocker exec hw-redis redis-cli ping\n</code></pre></p>"},{"location":"getting-started/configuration/#next-steps","title":"Next Steps","text":"<ul> <li>Quick Start Guide - Build your first endpoints</li> <li>Authentication Guide - Configure authentication</li> <li>Security Guide - Production security</li> <li>Deployment Guide - Deploy to production</li> </ul>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>This guide will walk you through setting up the FastAPI HTTP/WebSocket template for local development.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<p>Ensure you have the following installed:</p> Requirement Version Purpose Python 3.13+ Application runtime Docker 24.0+ Containerization Docker Compose v2+ Service orchestration uv latest Python package manager Git latest Version control"},{"location":"getting-started/installation/#install-uv-python-package-manager","title":"Install uv (Python Package Manager)","text":"<pre><code># Install uv\npip install uv\n\n# Verify installation\nuv --version\n</code></pre>"},{"location":"getting-started/installation/#clone-the-repository","title":"Clone the Repository","text":"<pre><code># Clone the repository\ngit clone https://github.com/acikabubo/fastapi-http-websocket.git\ncd fastapi-http-websocket\n\n# Or if using as a template\ncookiecutter gh:acikabubo/fastapi-http-websocket\n</code></pre>"},{"location":"getting-started/installation/#install-python-dependencies","title":"Install Python Dependencies","text":"<pre><code># Sync all dependencies\nuv sync\n\n# Sync with dev dependencies\nuv sync --all-groups\n\n# Activate virtual environment\nsource .venv/bin/activate  # Linux/macOS\n# OR\n.venv\\Scripts\\activate  # Windows\n</code></pre>"},{"location":"getting-started/installation/#start-infrastructure-services","title":"Start Infrastructure Services","text":"<p>The application requires several infrastructure services. Start them with Docker Compose:</p> <pre><code># Start all services in background\nmake start\n\n# Or using docker-compose directly\ndocker compose -f docker/docker-compose.yml up -d\n</code></pre> <p>This will start:</p> <ul> <li>PostgreSQL (port 5432) - Main database</li> <li>Redis (port 6379) - Cache and rate limiting</li> <li>Keycloak (port 8080) - Authentication server</li> <li>Prometheus (port 9090) - Metrics collection</li> <li>Grafana (port 3000) - Dashboards and visualization</li> <li>Loki (port 3100) - Log aggregation</li> <li>Grafana Alloy - Log collection agent</li> <li>Traefik (ports 80/443/8080) - Reverse proxy</li> </ul>"},{"location":"getting-started/installation/#verify-services","title":"Verify Services","text":"<pre><code># Check all services are running\ndocker ps\n\n# Check service health\ncurl http://localhost:8000/health  # Application (after starting)\ncurl http://localhost:8080/health  # Keycloak\ncurl http://localhost:9090/-/healthy  # Prometheus\n</code></pre>"},{"location":"getting-started/installation/#initialize-the-database","title":"Initialize the Database","text":"<p>Run database migrations to set up the schema:</p> <pre><code># Run migrations\nmake migrate\n\n# Or using alembic directly\nuv run alembic upgrade head\n\n# Verify current migration\nmake migration-current\n</code></pre>"},{"location":"getting-started/installation/#configure-keycloak","title":"Configure Keycloak","text":"<p>Keycloak is pre-configured with a realm export, but you need to verify the configuration:</p> <ol> <li>Access Keycloak Admin Console: http://localhost:8080</li> <li>Login with credentials from <code>docker/.kc_env</code>:</li> <li>Username: <code>admin</code></li> <li>Password: <code>admin</code> (change in production!)</li> <li>Verify Realm: Check that the <code>development</code> realm exists</li> <li>Verify Client: Check that the <code>fastapi-app</code> client is configured</li> </ol>"},{"location":"getting-started/installation/#environment-configuration","title":"Environment Configuration","text":"<p>Create your environment file from the example:</p> <pre><code># Copy example environment file\ncp .env.example .env\n\n# Edit configuration\nnano .env  # or your preferred editor\n</code></pre>"},{"location":"getting-started/installation/#key-environment-variables","title":"Key Environment Variables","text":"<pre><code># Application\nENVIRONMENT=development\nDEBUG=true\nLOG_LEVEL=DEBUG\n\n# Database\nDATABASE_URL=postgresql+asyncpg://fastapi:fastapi@localhost:5432/fastapi\n\n# Redis\nREDIS_IP=localhost\nREDIS_PORT=6379\nMAIN_REDIS_DB=0\nAUTH_REDIS_DB=1\n\n# Keycloak\nKEYCLOAK_BASE_URL=http://localhost:8080\nKEYCLOAK_REALM=development\nKEYCLOAK_CLIENT_ID=fastapi-app\nKEYCLOAK_CLIENT_SECRET=your-client-secret\n\n# Rate Limiting\nRATE_LIMIT_ENABLED=true\nRATE_LIMIT_PER_MINUTE=60\nWS_MAX_CONNECTIONS_PER_USER=5\n</code></pre>"},{"location":"getting-started/installation/#start-the-application","title":"Start the Application","text":""},{"location":"getting-started/installation/#option-1-using-make-recommended","title":"Option 1: Using Make (Recommended)","text":"<pre><code># Start with auto-reload\nmake serve\n</code></pre>"},{"location":"getting-started/installation/#option-2-using-uvicorn-directly","title":"Option 2: Using Uvicorn Directly","text":"<pre><code># Start application\nuv run uvicorn app:application --host 0.0.0.0 --port 8000 --reload\n</code></pre>"},{"location":"getting-started/installation/#option-3-using-docker-shell","title":"Option 3: Using Docker Shell","text":"<pre><code># Enter development container\nmake shell\n\n# Inside container\nuvicorn app:application --host 0.0.0.0 --reload\n</code></pre>"},{"location":"getting-started/installation/#verify-installation","title":"Verify Installation","text":""},{"location":"getting-started/installation/#check-application-health","title":"Check Application Health","text":"<pre><code>curl http://localhost:8000/health\n</code></pre> <p>Expected response: <pre><code>{\n  \"status\": \"ok\",\n  \"version\": \"0.1.0\",\n  \"environment\": \"development\"\n}\n</code></pre></p>"},{"location":"getting-started/installation/#access-api-documentation","title":"Access API Documentation","text":"<p>Open in your browser:</p> <ul> <li>OpenAPI/Swagger UI: http://localhost:8000/docs</li> <li>ReDoc: http://localhost:8000/redoc</li> </ul>"},{"location":"getting-started/installation/#access-monitoring-dashboards","title":"Access Monitoring Dashboards","text":"<ul> <li>Grafana: http://localhost:3000 (admin/admin)</li> <li>FastAPI Metrics dashboard</li> <li>Application Logs dashboard</li> <li>Keycloak Metrics dashboard</li> <li>Prometheus: http://localhost:9090</li> <li>Traefik Dashboard: http://localhost:8080</li> </ul>"},{"location":"getting-started/installation/#development-tools","title":"Development Tools","text":""},{"location":"getting-started/installation/#pre-commit-hooks","title":"Pre-commit Hooks","text":"<p>Install pre-commit hooks for code quality:</p> <pre><code># Install pre-commit\nuv run pre-commit install\n\n# Run hooks manually\nuv run pre-commit run --all-files\n</code></pre>"},{"location":"getting-started/installation/#code-quality-checks","title":"Code Quality Checks","text":"<pre><code># Run linter\nmake ruff-check\n\n# Run security scan\nmake bandit-scan\n\n# Check for dead code\nmake dead-code-scan\n\n# Run tests\nmake test\n\n# Run tests with coverage\nmake test-coverage\n</code></pre>"},{"location":"getting-started/installation/#troubleshooting","title":"Troubleshooting","text":""},{"location":"getting-started/installation/#services-not-starting","title":"Services Not Starting","text":"<pre><code># Check logs\ndocker compose -f docker/docker-compose.yml logs\n\n# Restart services\nmake stop\nmake start\n</code></pre>"},{"location":"getting-started/installation/#database-connection-issues","title":"Database Connection Issues","text":"<pre><code># Check PostgreSQL is running\ndocker ps | grep postgres\n\n# Check database logs\ndocker logs hw-db\n\n# Recreate database\ndocker compose -f docker/docker-compose.yml down -v\ndocker compose -f docker/docker-compose.yml up -d hw-db\nmake migrate\n</code></pre>"},{"location":"getting-started/installation/#port-already-in-use","title":"Port Already in Use","text":"<pre><code># Check what's using the port\nsudo lsof -i :8000  # Linux/macOS\nnetstat -ano | findstr :8000  # Windows\n\n# Stop conflicting process or change port\nuvicorn app:application --port 8001\n</code></pre>"},{"location":"getting-started/installation/#redis-connection-issues","title":"Redis Connection Issues","text":"<pre><code># Test Redis connection\ndocker exec hw-redis redis-cli ping\n\n# Check Redis logs\ndocker logs hw-redis\n</code></pre>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<p>Now that you have everything installed:</p> <ol> <li>Quick Start Guide - Create your first endpoints</li> <li>Configuration Guide - Customize your setup</li> <li>Authentication Guide - Set up auth</li> </ol>"},{"location":"getting-started/installation/#clean-up","title":"Clean Up","text":"<p>When you're done developing:</p> <pre><code># Stop all services\nmake stop\n\n# Remove all containers and volumes\ndocker compose -f docker/docker-compose.yml down -v\n\n# Clean up Docker resources\ndocker system prune -f\n</code></pre>"},{"location":"getting-started/installation/#additional-resources","title":"Additional Resources","text":"<ul> <li>Development Guide</li> <li>Testing Guide</li> <li>Docker Deployment</li> <li>Troubleshooting Guide</li> </ul>"},{"location":"getting-started/quickstart/","title":"Quick Start","text":"<p>Get your first HTTP and WebSocket endpoints running in 10 minutes.</p> <p>Prerequisites</p> <p>Make sure you've completed the Installation guide before proceeding.</p>"},{"location":"getting-started/quickstart/#start-the-application","title":"Start the Application","text":"<pre><code># Start infrastructure services\nmake start\n\n# Start the application with auto-reload\nmake serve\n</code></pre> <p>The application should now be running at http://localhost:8000</p>"},{"location":"getting-started/quickstart/#your-first-http-endpoint","title":"Your First HTTP Endpoint","text":"<p>Let's create a simple HTTP endpoint to manage books.</p>"},{"location":"getting-started/quickstart/#1-create-the-model","title":"1. Create the Model","text":"<p>Create <code>app/models/book.py</code>:</p> <pre><code>from sqlmodel import Field, SQLModel\n\nclass Book(SQLModel, table=True):\n    \"\"\"Book model.\"\"\"\n\n    id: int | None = Field(default=None, primary_key=True)\n    title: str = Field(index=True)\n    author: str\n    isbn: str = Field(unique=True)\n    published_year: int\n</code></pre>"},{"location":"getting-started/quickstart/#2-create-a-migration","title":"2. Create a Migration","text":"<pre><code>make migration msg=\"add book model\"\nmake migrate\n</code></pre>"},{"location":"getting-started/quickstart/#3-create-the-repository","title":"3. Create the Repository","text":"<p>Create <code>app/repositories/book_repository.py</code>:</p> <pre><code>from app.models.book import Book\nfrom app.repositories.base_repository import BaseRepository\n\nclass BookRepository(BaseRepository[Book]):\n    \"\"\"Repository for Book operations.\"\"\"\n    pass\n</code></pre>"},{"location":"getting-started/quickstart/#4-create-http-endpoints","title":"4. Create HTTP Endpoints","text":"<p>Create <code>app/api/http/book.py</code>:</p> <pre><code>from fastapi import APIRouter, Depends, HTTPException, status\nfrom app.models.book import Book\nfrom app.repositories.book_repository import BookRepository\nfrom app.storage.db import async_session\n\nrouter = APIRouter(prefix=\"/books\", tags=[\"books\"])\n\n@router.post(\"/\", response_model=Book, status_code=status.HTTP_201_CREATED)\nasync def create_book(book: Book):\n    \"\"\"Create a new book.\"\"\"\n    async with async_session() as session:\n        repo = BookRepository(session)\n        return await repo.create(book)\n\n@router.get(\"/\", response_model=list[Book])\nasync def get_books():\n    \"\"\"Get all books.\"\"\"\n    async with async_session() as session:\n        repo = BookRepository(session)\n        return await repo.get_all()\n\n@router.get(\"/{book_id}\", response_model=Book)\nasync def get_book(book_id: int):\n    \"\"\"Get book by ID.\"\"\"\n    async with async_session() as session:\n        repo = BookRepository(session)\n        book = await repo.get_by_id(book_id)\n        if not book:\n            raise HTTPException(\n                status_code=status.HTTP_404_NOT_FOUND,\n                detail=\"Book not found\"\n            )\n        return book\n</code></pre>"},{"location":"getting-started/quickstart/#5-test-the-endpoint","title":"5. Test the Endpoint","text":"<pre><code># Create a book\ncurl -X POST http://localhost:8000/books/ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"title\": \"Clean Code\",\n    \"author\": \"Robert C. Martin\",\n    \"isbn\": \"978-0132350884\",\n    \"published_year\": 2008\n  }'\n\n# Get all books\ncurl http://localhost:8000/books/\n\n# Get specific book\ncurl http://localhost:8000/books/1\n</code></pre> <p>Or visit the interactive API docs: http://localhost:8000/docs</p>"},{"location":"getting-started/quickstart/#your-first-websocket-handler","title":"Your First WebSocket Handler","text":"<p>Let's create a WebSocket handler to get books.</p>"},{"location":"getting-started/quickstart/#1-add-package-id","title":"1. Add Package ID","text":"<p>Edit <code>app/api/ws/constants.py</code>:</p> <pre><code>class PkgID(IntEnum):\n    \"\"\"WebSocket package IDs.\"\"\"\n    # ... existing handlers ...\n    GET_BOOKS = 100\n    CREATE_BOOK = 101\n</code></pre>"},{"location":"getting-started/quickstart/#2-create-websocket-handler","title":"2. Create WebSocket Handler","text":"<p>Create <code>app/api/ws/handlers/book.py</code>:</p> <pre><code>from app.routing import pkg_router\nfrom app.api.ws.constants import PkgID\nfrom app.schemas.models import RequestModel, ResponseModel\nfrom app.repositories.book_repository import BookRepository\nfrom app.storage.db import async_session\n\n@pkg_router.register(PkgID.GET_BOOKS)\nasync def get_books_handler(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"Get all books via WebSocket.\"\"\"\n    async with async_session() as session:\n        repo = BookRepository(session)\n        books = await repo.get_all()\n\n        return ResponseModel.success(\n            request.pkg_id,\n            request.req_id,\n            data=[book.model_dump() for book in books]\n        )\n\n@pkg_router.register(PkgID.CREATE_BOOK)\nasync def create_book_handler(request: RequestModel) -&gt; ResponseModel:\n    \"\"\"Create a book via WebSocket.\"\"\"\n    async with async_session() as session:\n        repo = BookRepository(session)\n        book_data = request.data\n        book = Book(**book_data)\n        created_book = await repo.create(book)\n\n        return ResponseModel.success(\n            request.pkg_id,\n            request.req_id,\n            data=created_book.model_dump()\n        )\n</code></pre>"},{"location":"getting-started/quickstart/#3-test-websocket-handler","title":"3. Test WebSocket Handler","text":"<p>Using <code>wscat</code> or any WebSocket client:</p> <pre><code># Install wscat (if needed)\nnpm install -g wscat\n\n# Connect (replace TOKEN with actual JWT token from Keycloak)\nwscat -c \"ws://localhost:8000/web?access_token=YOUR_TOKEN\"\n\n# Send message\n{\"pkg_id\": 100, \"req_id\": \"test-001\", \"data\": {}}\n\n# Expected response\n{\n  \"pkg_id\": 100,\n  \"req_id\": \"test-001\",\n  \"status_code\": 0,\n  \"data\": [...]\n}\n</code></pre>"},{"location":"getting-started/quickstart/#add-rbac-permissions","title":"Add RBAC Permissions","text":"<p>Add role requirements directly to your handler decorators:</p> <p>WebSocket Handler (<code>app/api/ws/handlers/book_handler.py</code>): <pre><code>@pkg_router.register(\n    PkgID.GET_BOOKS,\n    json_schema=GetBooksModel,\n    roles=[\"get-books\"]  # Define required roles\n)\nasync def get_books_handler(request: RequestModel) -&gt; ResponseModel:\n    ...\n\n@pkg_router.register(\n    PkgID.CREATE_BOOK,\n    json_schema=CreateBookModel,\n    roles=[\"create-book\", \"admin\"]  # Multiple roles = user must have ALL\n)\nasync def create_book_handler(request: RequestModel) -&gt; ResponseModel:\n    ...\n</code></pre></p> <p>HTTP Endpoint (<code>app/api/http/book.py</code>): <pre><code>from app.dependencies.permissions import require_roles\n\n@router.get(\n    \"/books\",\n    dependencies=[Depends(require_roles(\"get-books\"))]\n)\nasync def get_books():\n    ...\n\n@router.post(\n    \"/books\",\n    dependencies=[Depends(require_roles(\"create-book\", \"admin\"))]\n)\nasync def create_book(book: Book):\n    ...\n</code></pre></p> <p>Now only users with appropriate roles can access these endpoints!</p>"},{"location":"getting-started/quickstart/#next-steps","title":"Next Steps","text":"<p>Congratulations! You've created your first HTTP and WebSocket endpoints. Next, learn about:</p> <ul> <li>Authentication - Secure your endpoints</li> <li>Rate Limiting - Protect against abuse</li> <li>Database Operations - Advanced database patterns</li> <li>Testing - Write tests for your endpoints</li> </ul>"},{"location":"getting-started/quickstart/#see-also","title":"See Also","text":"<ul> <li>HTTP API Guide</li> <li>WebSocket API Guide</li> <li>Design Patterns</li> </ul>"},{"location":"guides/","title":"User Guides","text":"<p>Step-by-step guides for common tasks and features.</p>"},{"location":"guides/#available-guides","title":"Available Guides","text":"<ul> <li>Authentication - Keycloak integration and JWT tokens</li> <li>HTTP Endpoints - Creating REST API endpoints</li> <li>WebSocket Handlers - Building WebSocket handlers</li> <li>Rate Limiting - Implementing rate limits</li> <li>Audit Logging - Tracking user actions</li> <li>Database Operations - Working with PostgreSQL</li> <li>Monitoring - Observability and metrics</li> </ul>"}]}